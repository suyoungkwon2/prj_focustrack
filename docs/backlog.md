# 백로그 및 개선 아이디어

## Digital Routine 기능

- **`processTenMinuteBlocks` 함수 개선:**
    - **정확한 블록 내 Duration 계산:** 현재 10분 블록 데이터 계산 시 세션 전체 `duration`을 사용하고 있음. 더 정확한 분석을 위해 해당 10분 블록 내에서 실제로 머무른 시간만 계산하도록 `calculateDurationInBlock` 로직 적용 필요.
    - **사용자 처리 최적화:** 현재 모든 사용자 ID를 가져와 처리하고 있어 사용자 수가 많아지면 비효율적일 수 있음. 최근 활동 사용자만 처리하거나, 사용자별 처리를 분산하는 등 최적화 방안 고려 필요.


-   **사용자 로컬 시간대 기준 일별 데이터 리셋:** 현재 일별 데이터 집계 및 리셋(`aggregateDailyDurations` 함수)은 고정된 시간대(America/New_York) 기준으로 오전 5시에 실행됩니다. 향후 사용자의 로컬 시간대에 맞춰 오전 5시에 집계/리셋이 이루어지도록 개선하는 것을 고려합니다.
    *   필요 작업:
        *   사용자별 시간대 정보 저장 (예: `/users/{userId}/settings/timezone`).
        *   `aggregateDailyDurations` 함수 로직 수정: 더 자주(예: 1시간마다) 실행하고, 함수 내부에서 각 사용자의 로컬 시간대를 확인하여 5시가 지났는지 판단 후 조건부 실행.
        *   또는 클라이언트 측에서 사용자의 시간대를 포함하여 데이터 집계 요청을 보내는 방식 고려. 